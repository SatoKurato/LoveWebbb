<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Gift Code</title>
    <link rel="stylesheet" href="Keypad.css">
</head>
<body>
    <canvas id="star-bg"></canvas>
    <div class="container">
      <h2 class="title">Special Gift</h2>
      <div class="code-circles" id="code-circles">
        <span class="circle"></span>
        <span class="circle"></span>
        <span class="circle"></span>
        <span class="circle"></span>
        <span class="circle"></span>
        <span class="circle"></span>
      </div>
      <div class="keypad">
        <button class="key" data-num="1">1</button>
        <button class="key" data-num="2">2</button>
        <button class="key" data-num="3">3</button>
        <button class="key" data-num="4">4</button>
        <button class="key" data-num="5">5</button>
        <button class="key" data-num="6">6</button>
        <button class="key" data-num="7">7</button>
        <button class="key" data-num="8">8</button>
        <button class="key" data-num="9">9</button>
        <button class="key zero" data-num="0">0</button>
        <button class="key del" id="del">ðŸ—‘ à¸¥à¸š</button>
      </div>
    </div>
    <script>
      // Starry background + shooting stars
      const canvas = document.getElementById('star-bg');
      const ctx = canvas.getContext('2d');
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      // Generate stars
      const stars = Array.from({length: 120}, () => ({
        x: Math.random() * window.innerWidth,
        y: Math.random() * window.innerHeight,
        r: Math.random() * 1.5 + 0.5,
        a: Math.random() * 2 * Math.PI,
        speed: Math.random() * 0.2 + 0.05
      }));
      // Shooting stars
      const shootingStars = [];
      function spawnShootingStar() {
        const startX = Math.random() * canvas.width * 0.8;
        const startY = Math.random() * canvas.height * 0.3;
        const length = Math.random() * 120 + 100;
        const angle = Math.random() * (Math.PI/3) + Math.PI/6;
        const speed = Math.random() * 6 + 6;
        shootingStars.push({
          x: startX,
          y: startY,
          len: length,
          angle: angle,
          speed: speed,
          progress: 0,
          alpha: 1
        });
      }
      setInterval(spawnShootingStar, 1200);
      function drawShootingStars() {
        for (let i = shootingStars.length - 1; i >= 0; i--) {
          const s = shootingStars[i];
          const dx = Math.cos(s.angle) * s.speed;
          const dy = Math.sin(s.angle) * s.speed;
          s.x += dx;
          s.y += dy;
          s.progress += s.speed;
          s.alpha *= 0.97;
          ctx.save();
          ctx.globalAlpha = s.alpha;
          ctx.beginPath();
          ctx.moveTo(s.x, s.y);
          ctx.lineTo(s.x - Math.cos(s.angle) * s.len, s.y - Math.sin(s.angle) * s.len);
          ctx.strokeStyle = '#fff';
          ctx.lineWidth = 2.5;
          ctx.shadowColor = '#ff69b4';
          ctx.shadowBlur = 16;
          ctx.stroke();
          ctx.restore();
          if (s.progress > s.len * 1.2 || s.alpha < 0.05) {
            shootingStars.splice(i, 1);
          }
        }
      }
      function drawStars() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (const s of stars) {
          ctx.save();
          ctx.globalAlpha = 0.7 + 0.3 * Math.sin(s.a);
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, 2 * Math.PI);
          ctx.fillStyle = '#fff';
          ctx.shadowColor = '#ff69b4';
          ctx.shadowBlur = 8;
          ctx.fill();
          ctx.restore();
          s.a += s.speed * 0.5;
        }
        drawShootingStars();
      }
      setInterval(drawStars, 40);

      // Keypad logic
      const circles = document.querySelectorAll('.circle');
      const keys = document.querySelectorAll('.key');
      let code = '';
      keys.forEach(btn => {
        btn.onclick = function() {
          if(btn.classList.contains('del')) {
            code = code.slice(0,-1);
          } else if(code.length < circles.length) {
            code += btn.dataset.num;
          }
          circles.forEach((c,i)=>{
            c.textContent = code[i] ? code[i] : '';
          });
          // Check code: 6 digits, must be '010167'
          if(code.length === circles.length) {
            if(code === '010167') {
              window.location.href = 'LoveMessage.html';
            } else {
              circles.forEach(c=>c.classList.add('wrong'));
              setTimeout(()=>{
                circles.forEach(c=>c.classList.remove('wrong'));
                code = '';
                circles.forEach(c=>c.textContent = '');
              }, 800);
            }
          }
        }
      });
    </script>
</body>
</html>
